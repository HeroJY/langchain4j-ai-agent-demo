# LangChain4j AI Agent Demo

åŸºäºSpring Bootå’ŒLangChain4jçš„AIæ™ºèƒ½ä½“æ¼”ç¤ºé¡¹ç›®ï¼Œé›†æˆäº†DeepSeek APIå’Œå¤šç§å·¥å…·ï¼Œå®ç°äº†åŠ¨æ€ç³»ç»Ÿæç¤ºè¯ç®¡ç†å’ŒAIå¯¹è¯åŠŸèƒ½ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– **AIå¯¹è¯ç³»ç»Ÿ**: åŸºäºDeepSeekå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½å¯¹è¯
- ğŸŒŠ **æµå¼å“åº”**: æ”¯æŒæµå¼èŠå¤©ï¼Œæä¾›æ›´æµç•…çš„å¯¹è¯ä½“éªŒ
- ğŸ­ **å¤šåœºæ™¯æ”¯æŒ**: å†…ç½®å¤šç§åœºæ™¯æ¨¡å¼ï¼ŒåŒ…æ‹¬ä»£ç å®¡æŸ¥ã€æŠ€æœ¯å†™ä½œã€å®¢æˆ·æ”¯æŒå’Œç¿»è¯‘
- ğŸ”§ **å·¥å…·é›†æˆ**: é›†æˆå¤šç§å·¥å…·ï¼ŒåŒ…æ‹¬ç½‘ç»œæœç´¢ã€å‘½ä»¤æ‰§è¡Œç­‰
- ğŸ“ **åŠ¨æ€æç¤ºè¯**: æ”¯æŒåŠ¨æ€ç®¡ç†ç³»ç»Ÿæç¤ºè¯ï¼Œæ”¯æŒå˜é‡æ›¿æ¢å’Œä¸Šä¸‹æ–‡æ„ŸçŸ¥
- ğŸŒ **RESTful API**: æä¾›å®Œæ•´çš„REST APIæ¥å£
- ğŸ“Š **æ—¥å¿—è®°å½•**: è¯¦ç»†çš„è¯·æ±‚å’Œå“åº”æ—¥å¿—
- ğŸ–¥ï¸ **Webç•Œé¢**: æä¾›æµå¼èŠå¤©Webç•Œé¢ï¼Œæ–¹ä¾¿æµ‹è¯•å’Œæ¼”ç¤º

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: Spring Boot 3.x
- **AIæ¡†æ¶**: LangChain4j
- **è¯­è¨€æ¨¡å‹**: DeepSeek API
- **æ„å»ºå·¥å…·**: Maven
- **å¼€å‘è¯­è¨€**: Java 17+

## ğŸ“ é¡¹ç›®ç»“æ„

```
langchain4j-ai-agent-demo/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main/
â”‚       â”œâ”€â”€ java/
â”‚       â”‚   â””â”€â”€ com/example/langchain4jdeepseek/
â”‚       â”‚       â”œâ”€â”€ config/          # é…ç½®ç±»
â”‚       â”‚       â”œâ”€â”€ controller/      # RESTæ§åˆ¶å™¨
â”‚       â”‚       â”œâ”€â”€ model/           # æ•°æ®æ¨¡å‹
â”‚       â”‚       â”œâ”€â”€ service/         # ä¸šåŠ¡é€»è¾‘
â”‚       â”‚       â””â”€â”€ tools/           # AIå·¥å…·ç±»
â”‚       â””â”€â”€ resources/
â”‚           â”œâ”€â”€ application.properties      # åº”ç”¨é…ç½®
â”‚           â”œâ”€â”€ application-local.properties # æœ¬åœ°APIå¯†é’¥é…ç½®
â”‚           â”œâ”€â”€ command-blacklist.txt      # å‘½ä»¤æ‰§è¡Œé»‘åå•é…ç½®
â”‚           â”œâ”€â”€ system-prompts/            # ç³»ç»Ÿæç¤ºè¯æ¨¡æ¿
â”‚           â”‚   â”œâ”€â”€ default.prompt         # é»˜è®¤æç¤ºè¯
â”‚           â”‚   â”œâ”€â”€ code_reviewer.prompt   # ä»£ç å®¡æŸ¥åœºæ™¯
â”‚           â”‚   â”œâ”€â”€ customer_support.prompt # å®¢æˆ·æ”¯æŒåœºæ™¯
â”‚           â”‚   â”œâ”€â”€ technical_writer.prompt # æŠ€æœ¯å†™ä½œåœºæ™¯
â”‚           â”‚   â””â”€â”€ translator.prompt      # ç¿»è¯‘åœºæ™¯
â”‚           â”œâ”€â”€ static/                    # é™æ€èµ„æº
â”‚           â”‚   â”œâ”€â”€ streaming-chat.html    # æµå¼èŠå¤©ç•Œé¢
â”‚           â”‚   â”œâ”€â”€ streaming-client-demo.html # æµå¼å®¢æˆ·ç«¯æ¼”ç¤º
â”‚           â”‚   â””â”€â”€ js/
â”‚           â”‚       â””â”€â”€ streaming-chat-client.js # æµå¼èŠå¤©å®¢æˆ·ç«¯è„šæœ¬
â”‚           â””â”€â”€ META-INF/
â”‚               â””â”€â”€ additional-spring-configuration-metadata.json # Springé…ç½®å…ƒæ•°æ®
â”œâ”€â”€ start.sh                      # ç»Ÿä¸€å¯åŠ¨è„šæœ¬
â”œâ”€â”€ test-all-features.sh          # åŠŸèƒ½æµ‹è¯•è„šæœ¬
â”œâ”€â”€ pom.xml                       # Mavené…ç½®
â””â”€â”€ README.md                     # é¡¹ç›®è¯´æ˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æœ¬åœ°å¼€å‘

1. å…‹éš†ä»“åº“ï¼š
   ```bash
   git clone [ä»“åº“åœ°å€]
   cd langchain4j-ai-agent-demo
   ```

2. é…ç½®APIå¯†é’¥ï¼š
   ```bash
   cp src/main/resources/application.properties src/main/resources/application-local.properties
   ```
   ç„¶åç¼–è¾‘ `application-local.properties` æ–‡ä»¶ï¼Œæ·»åŠ æ‚¨çš„å®é™…APIå¯†é’¥ï¼š
   ```properties
   deepseek.api.key=æ‚¨çš„å®é™…DeepSeek APIå¯†é’¥
   tavily.api.key=æ‚¨çš„å®é™…Tavily APIå¯†é’¥
   ```

3. å¯åŠ¨åº”ç”¨ï¼ˆä½¿ç”¨æœ¬åœ°é…ç½®æ–‡ä»¶ï¼‰ï¼š
   ```bash
   # ä½¿ç”¨ç»Ÿä¸€çš„å¯åŠ¨è„šæœ¬ï¼ˆé»˜è®¤ä½¿ç”¨Spring Profileæ–¹å¼ï¼‰
   ./start.sh
   
   # æˆ–è€…ç›´æ¥æŒ‡å®šé…ç½®æ–‡ä»¶æ–¹å¼
   ./start.sh --config
   ```

4. è®¿é—®åº”ç”¨ï¼š
   æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:8080
   
   å¯ç”¨çš„Webç•Œé¢ï¼š
   - æµå¼èŠå¤©ç•Œé¢: http://localhost:8080/streaming-chat.html
   - æµå¼å®¢æˆ·ç«¯æ¼”ç¤º: http://localhost:8080/streaming-client-demo.html

### å¯åŠ¨è„šæœ¬è¯¦ç»†è¯´æ˜

é¡¹ç›®æä¾›äº†ç»Ÿä¸€çš„å¯åŠ¨è„šæœ¬ `start.sh`ï¼Œæ”¯æŒä¸¤ç§å¯åŠ¨æ–¹å¼ï¼š

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨Spring Profileï¼ˆæ¨èï¼‰
```bash
# ä½¿ç”¨é»˜è®¤æ–¹å¼å¯åŠ¨ï¼ˆSpring Profileï¼‰
./start.sh

# æˆ–è€…æ˜ç¡®æŒ‡å®šä½¿ç”¨Spring Profileæ–¹å¼
./start.sh --profile
```

å½“è®¾ç½® `SPRING_PROFILES_ACTIVE=local` æ—¶ï¼ŒSpring Bootä¼šè‡ªåŠ¨åŠ è½½ `application-local.properties` æ–‡ä»¶ã€‚

#### æ–¹æ³•äºŒï¼šç›´æ¥æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½®
```bash
# ç›´æ¥æŒ‡å®šé…ç½®æ–‡ä»¶æ–¹å¼å¯åŠ¨
./start.sh --config
```

è¿™ç§æ–¹å¼é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ç›´æ¥æŒ‡å®šé…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚

é…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåºå¦‚ä¸‹ï¼š
1. é¦–å…ˆåŠ è½½ `application.properties`ï¼ˆåŸºç¡€é…ç½®ï¼‰
2. ç„¶ååŠ è½½ `application-local.properties`ï¼ˆä¼šè¦†ç›–ç›¸åŒçš„é…ç½®é¡¹ï¼‰

## ğŸ“– APIæ–‡æ¡£

### å¥åº·æ£€æŸ¥

```http
GET /health
```

### AIå¯¹è¯

```http
POST /api/chat
Content-Type: application/json

{
  "message": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±",
  "scenario": "default"  // å¯é€‰ï¼ŒæŒ‡å®šåœºæ™¯
}
```

### å¸¦å˜é‡çš„AIå¯¹è¯

```http
POST /api/chat/with-variables
Content-Type: application/json

{
  "message": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±",
  "scenario": "default",  // å¯é€‰ï¼ŒæŒ‡å®šåœºæ™¯
  "variables": {          // å¯é€‰ï¼ŒåŠ¨æ€å˜é‡
    "user_name": "å¼ ä¸‰",
    "company": "ABCå…¬å¸"
  }
}
```

### æµå¼èŠå¤©

```http
POST /api/chat/stream
Content-Type: application/json

{
  "message": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±",
  "scenario": "default"  // å¯é€‰ï¼ŒæŒ‡å®šåœºæ™¯
}
```

### è·å–æµå¼ä¼šè¯å†…å®¹

```http
GET /api/chat/stream/{sessionId}
```

### è·å–å¯ç”¨åœºæ™¯

```http
GET /api/chat/scenarios
```

### è·å–å½“å‰åœºæ™¯

```http
GET /api/chat/current-scenario
```

### æ·»åŠ æ–°åœºæ™¯

```http
POST /api/chat/add-scenario
Content-Type: application/json

{
  "scenario": "æ–°åœºæ™¯åç§°",
  "template": "ç³»ç»Ÿæç¤ºè¯æ¨¡æ¿ï¼Œå¯ä»¥ä½¿ç”¨å˜é‡å¦‚${user_name}"
}
```

### æ›´æ–°ç³»ç»Ÿæç¤ºè¯

```http
POST /api/prompts/system
Content-Type: application/json

{
  "prompt": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„AIåŠ©æ‰‹ï¼Œè¯·ç”¨ç®€æ´æ˜äº†çš„è¯­è¨€å›ç­”é—®é¢˜ã€‚"
}
```

### è·å–å½“å‰ç³»ç»Ÿæç¤ºè¯

```http
GET /api/prompts/system
```


## ğŸ”§ å·¥å…·é›†æˆ

é¡¹ç›®é›†æˆäº†å¤šç§AIå·¥å…·ï¼Œæ‰©å±•äº†AIåŠ©æ‰‹çš„èƒ½åŠ›ï¼š

- **Tavilyæœç´¢å·¥å…·**: ä½¿ç”¨Tavily APIè¿›è¡Œç½‘ç»œæœç´¢ï¼Œè·å–æœ€æ–°ä¿¡æ¯
- **å‘½ä»¤æ‰§è¡Œå·¥å…·**: å®‰å…¨åœ°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œæ”¯æŒå‘½ä»¤é»‘åå•æœºåˆ¶
- **åŠ¨æ€å˜é‡ç³»ç»Ÿ**: æ”¯æŒåœ¨æç¤ºè¯ä¸­ä½¿ç”¨å˜é‡ï¼Œå¦‚`${current_date}`ã€`${current_time}`ç­‰

## ğŸ“ ç³»ç»Ÿæç¤ºè¯ç®¡ç†

ç³»ç»Ÿæ”¯æŒå¤šç§åœºæ™¯çš„æç¤ºè¯ç®¡ç†ï¼Œå­˜å‚¨åœ¨ `src/main/resources/system-prompts/` ç›®å½•ä¸‹ï¼š

- `default.prompt`: é»˜è®¤ç³»ç»Ÿæç¤ºè¯
- `code_reviewer.prompt`: ä»£ç å®¡æŸ¥åœºæ™¯æç¤ºè¯
- `customer_support.prompt`: å®¢æˆ·æ”¯æŒåœºæ™¯æç¤ºè¯
- `technical_writer.prompt`: æŠ€æœ¯å†™ä½œåœºæ™¯æç¤ºè¯
- `translator.prompt`: ç¿»è¯‘åœºæ™¯æç¤ºè¯

### åŠ¨æ€å˜é‡æ”¯æŒ

ç³»ç»Ÿæç¤ºè¯æ”¯æŒä»¥ä¸‹åŠ¨æ€å˜é‡ï¼š

- `${current_date}`: å½“å‰æ—¥æœŸ
- `${current_time}`: å½“å‰æ—¶é—´
- `${current_datetime}`: å½“å‰æ—¥æœŸå’Œæ—¶é—´
- è‡ªå®šä¹‰å˜é‡: é€šè¿‡APIä¼ å…¥çš„å˜é‡ï¼Œå¦‚`${user_name}`ã€`${company}`ç­‰

### åœºæ™¯åˆ‡æ¢

å¯ä»¥é€šè¿‡APIåŠ¨æ€åˆ‡æ¢ä¸åŒåœºæ™¯ï¼Œæ— éœ€é‡å¯åº”ç”¨ï¼š

```http
POST /api/chat
Content-Type: application/json

{
  "message": "è¯·å®¡æŸ¥è¿™æ®µä»£ç ",
  "scenario": "code_reviewer"
}
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰åŠŸèƒ½æµ‹è¯•

```bash
./test-all-features.sh
```

### æµ‹è¯•æµå¼èŠå¤©åŠŸèƒ½

1. æ‰“å¼€æµå¼èŠå¤©ç•Œé¢: http://localhost:8080/streaming-chat.html
2. è¾“å…¥æ¶ˆæ¯å¹¶é€‰æ‹©åœºæ™¯ï¼Œä½“éªŒæµå¼å“åº”

### æµ‹è¯•ä¸åŒåœºæ™¯

é¡¹ç›®å†…ç½®äº†å¤šç§åœºæ™¯ï¼Œå¯ä»¥é€šè¿‡APIæˆ–Webç•Œé¢æµ‹è¯•ï¼š

- **é»˜è®¤åœºæ™¯**: é€šç”¨AIåŠ©æ‰‹
- **ä»£ç å®¡æŸ¥**: ä¸“ä¸šçš„ä»£ç å®¡æŸ¥å‘˜
- **æŠ€æœ¯å†™ä½œ**: æŠ€æœ¯æ–‡æ¡£ç¼–å†™å‘˜
- **å®¢æˆ·æ”¯æŒ**: ä¸“ä¸šçš„å®¢æˆ·æ”¯æŒä»£ç†
- **ç¿»è¯‘**: ä¸“ä¸šçš„ç¿»è¯‘ä¸“å®¶

### æµ‹è¯•åŠ¨æ€å˜é‡

```http
POST /api/chat/with-variables
Content-Type: application/json

{
  "message": "è¯·ä¸º${user_name}å†™ä¸€å°ä»‹ç»ä¿¡",
  "scenario": "technical_writer",
  "variables": {
    "user_name": "å¼ ä¸‰",
    "company": "ABCå…¬å¸"
  }
}
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

é¡¹ç›®å®ç°äº†å¤šé¡¹å®‰å…¨æªæ–½æ¥ä¿æŠ¤ç³»ç»Ÿå®‰å…¨ï¼š

1. **å‘½ä»¤æ‰§è¡Œå®‰å…¨**
   - å®ç°äº†å‘½ä»¤é»‘åå•æœºåˆ¶ï¼Œé˜²æ­¢æ‰§è¡Œå±é™©å‘½ä»¤
   - é»‘åå•åŒ…å«ç³»ç»Ÿç ´åã€ç”¨æˆ·ç®¡ç†ã€ç½‘ç»œé…ç½®ç­‰å„ç±»å±é™©å‘½ä»¤
   - æ”¯æŒä»é…ç½®æ–‡ä»¶åŠ¨æ€åŠ è½½é»‘åå•åˆ—è¡¨

2. **APIå¯†é’¥ç®¡ç†**
   - æœ¬åœ°é…ç½®æ–‡ä»¶ `application-local.properties` ç”¨äºå­˜å‚¨APIå¯†é’¥
   - å»ºè®®ä¸è¦å°†å®é™…APIå¯†é’¥æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
   - æ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡æˆ–å¤–éƒ¨é…ç½®æ–‡ä»¶ç®¡ç†å¯†é’¥

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›é¡¹ç›®ï¼

å¦‚æœæ‚¨æƒ³ä¸ºæ­¤é¡¹ç›®è´¡çŒ®ä»£ç ï¼Œè¯·ç¡®ä¿ï¼š

1. ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ä»»ä½•APIå¯†é’¥
2. ä½¿ç”¨å ä½ç¬¦ä»£æ›¿å®é™…çš„å¯†é’¥å€¼
3. åœ¨æäº¤ä»£ç å‰æ£€æŸ¥æ˜¯å¦æ„å¤–åŒ…å«äº†æ•æ„Ÿä¿¡æ¯

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ™ è‡´è°¢

- [LangChain4j](https://github.com/langchain4j/langchain4j) - Javaçš„LLMæ¡†æ¶
- [DeepSeek](https://www.deepseek.com/) - å¤§è¯­è¨€æ¨¡å‹APIæœåŠ¡
- [Tavily](https://tavily.com/) - æœç´¢APIæœåŠ¡
